 



Для начала обратимся к Википедии и узнаем, что есть такое Node.js и JavaScript:
 Node или Node.js — программная платформа, основанная на движке V8 (транслирующем JavaScript в машинный код), превращающая JavaScript из узкоспециализированного языка в язык общего назначения. Node.js добавляет возможность JavaScript взаимодействовать с устройствами ввода-вывода через свой API(написанный на C++), подключать другие внешние библиотеки, написанные на разных языках, обеспечивая вызовы к ним из JavaScript-кода. Node.js применяется преимущественно на сервере, выполняя роль веб-сервера, но есть возможность разрабатывать на Node.js и десктопные оконные приложения (при помощи NW.js, AppJS или Electron для Linux, Windows и macOS) и даже программировать микроконтроллеры (например, tessel и espruino). В основе Node.js лежит событийно-ориентированное и асинхронное (или реактивное) программирование с неблокирующим вводом/выводом (Источник)

А теперь более простыми словами.

Что такое Node.js?

Node.js (или просто Node) — это серверная платформа для работы с JavaScript через движок V8. JavaScript выполняет действие на стороне клиента, а Node — на сервере. С помощью Node можно писать полноценные приложения. Node умеет работать с внешними библиотеками, вызывать команды из кода на JavaScript и выполнять роль веб-сервера.

В чём преимущество Node?

C Node проще масштабироваться. При одновременном подключении к серверу тысяч пользователей Node работает асинхронно, то есть ставит приоритеты и распределяет ресурсы грамотнее. Java же, например, выделяет на каждое подключение отдельный поток.

Откуда Node вообще взялся?

Node появился в 2009 году благодаря Райану Далу. До этого в серверах царил подход «один поток на каждое соединение», а Дал придумал использовать систему, которая ориентирована на события. То есть реагирует на действие или бездействие и выделяет под это ресурс. Главная цель Node — построение масштабируемых сетевых серверов. (Источник)

Node.JS — это программное средство для выполнения JavaScript.  То есть ставится Node.JS и Node.JS выполняет JavaScript на сервере, на десктопе, на ноутбуке, на мобильных устройствах и так далее. JavaScript где угодно. Node.js был создан Райаном Далом в 2009 году.

Node.JS = V8 + I/O + библиотеки
Что же такое сделал Райан и почему Node.JS получил такое большое признание? Ведь на самом деле до Node.JS существовали другие попытки сделать то же самое. Node.JS создан на основе виртуальной машины V8. Эта виртуальная машина была создана компанией Google для браузера Chrome и она умеет выполнять JavaScript

V8: быстро, современно, экономно

Не просто умеет, она делает это очень хорошо. Она выполняет JavaScript быстро, она поддерживает практически все возможности современного JavaScript, самого современного стандарта который сейчас принят, плюс можно при помощи специальных флагов включить возможности будущего стандарта. Кроме того  V8 очень экономно расходует память, очень хорошо оптимизирована в этом плане, позволяет профилировать процессор, память, смотреть, что происходит. Очень, очень хорошая штука! 

Server-side JavaScript
Node.js — просто другой контекст JavaScript: он позволяет вам запускать JavaScript-код вне браузера.

Чтобы ваш JavaScript код выполнился на вычислительной машине вне браузера (на backend), он должен быть интерпретирован и, конечно же, выполнен. Именно это и делает Node.js. Для этого он использует движок V8 VM от Google — ту же самую среду исполнения для JavaScript, которую использует браузер Google Chrome.

 Кроме того, Node.js поставляется со множеством полезных модулей, так что вам не придется писать всё с нуля, как, например, вывод строки в консоль.

 Таким образом, Node.js состоит из 2 вещей: среды исполнения и полезных библиотек.

Почему Node.JS?

Что интересного может быть для нас в Node.JS как технологии, почему мы можем захотеть Node.JS.
Для этого есть ряд причин:

1. Хочу JavaScript! Если вы хорошо знаете JavaScript зачем изучать другой язык? Будем использовать его и на клиенте и на сервере.

2. Общий код на клиенте и на сервере. Значить мы можем использовать одинаковый код, ту же библиотеку и на клиенте и на сервере. Впрочем на практике это повторное использование весьма ограничено и оно обычно касается библиотек общего вида. Допустим есть объект «User». Этот объект «User» в браузере делает одно, использует возможности браузера, а на сервере он обычно делает другое, в том числе работает с базами данных, тут уже вообще другой код. То есть прямо таки разделяемого кода не так много, но тем не менее он есть.

3. Решает основные задачи для Web.  Node.JS предназначен для решения основных задач, которые перед нами ставит Web разработка. Хотим работать с базой данных, легко — Node.JS отлично работает с самыми распространенными современными базами данных. Хотим получить низкоуровневый доступ к сети http, https, tcp, udp, в Node.JS содержится отлично проработанная коллекция модулей. Node.JS Это инструмент который изначально проектировался для решения задач под Web и в нем очень много этого сделано. С другой стороны Node.JS наверно не самый лучший если вы хотите создать оконное приложение под Windows или посчитать число Пи с точностью до какого то n-го знака. В этом случае наверно будут более предпочтительны другие инструменты. Node.JS это средство которое решает основные задачи под Web и делает это хорошо.

4. Много соединений и задач одновременно. Node.JS лучше всего себя ведет там, где нужно поддерживать большое количество соединений. Например это 10 000 клиентов в чате одновременно или это онлайн игра, где тоже очень много игроков одновременно подключены и что то делают. Большое количество соединений, задач это то с чем Node.JS справляется хорошо. При этом эти задачи не должны быть вычислительными. Хотя если задачи вычислительные то в Node.JS есть средства для параллелизации, но они не так хорошо проработаны как на некоторых других платформах.

5. Легко сделать рабочий прототип. Следующее, это рабочий прототип. На Node.JS очень легко создать, что то готовое и заставить это работать, причем работать в том числе под нагрузкой. Когда мы разрабатываем, то современные методики разработки итеративны. То есть мы делаем что то, оно должно работать, потом мы добавляем к этому фичи, она опять работает, потом мы добавляем что то еще и так. И на Node.JS первый этап проходит очень быстро, а если все в порядке с архитектурой, то и дальше оно отлично расширяется.

6. Удобный менеджер пакетов, где много всего. В Node.JS есть очень удобный менеджер пакетов, NPM, мы его подробно рассмотрим и есть очень много готовых пакетов, которые можно поставить и работать с ними.

7. Большое и активное сообщество вокруг. Ну и наконец, сообщество. Есть много, много людей которые любят Node.JS, которые пишут под Node.JS, которые поддерживают то, что они сделали под Node.JS. Преимущественно это индивидуальные разработчики или небольшие компании плюс сообщество. По этому такая ситуация складывается, что есть очень много готовых пакетов, модулей которые нужно поставить и они вместе нормально работают. Для приложений на Node.JS, совершенно нормально если они используют двадцать, тридцать, пятьдесят, восемьдесят готовых модулей даже.  Такая вот матричная структура получается, когда есть много, много маленьких модулей которые вместе интегрируются и отлично работают, благодаря тому, что Node.JS предоставляет для этого Framework. Источник

 

Node.js это — среда выполнения JavaScript. Что же это значит, и как работает?
Окружение Node.js включает все, что вам нужно для выполнения программы, написанной на JavaScript.
dksqo7scsztppufvmkn5yfb_cva.png

Теперь у JavaScript есть возможность делать то, что могут делать другие скриптовые языки программирования, такие как Python.

Мы уже обсуждали первую строку этого определения: «Node.js — среда выполнения JavaScript, основанная на JavaScript движке V8 из Chrome». Теперь давайте разбираться в двух других строках, так мы сможем понять, почему Node.js так популярен.

I/O означает ввод/вывод. Это может быть что угодно: от чтения/записи локальных файлов до HTTP-запроса в API. I/O занимает время и, следовательно, блокирует другие функции.

Рассмотрим сценарий, в котором мы запрашиваем user1 и user2 из бекенда, а затем печатаем их на экране / в консоли. Ответ на этот запрос требует времени, но оба запроса пользовательских данных могут выполняться независимо и в одно и то же время.

cu3jgmhfru5w50kocs-dqg8-9_k.png


Блокирование ввода-вывода
В методе блокировки запрос данных user2 не запускается до тех пор, пока данные user1 не будут напечатаны на экране.

Если это был веб-сервер, нам нужно было бы начать новый поток для каждого нового пользователя. Но JavaScript однопоточен (но он имеет однопоточный цикл событий, о котором мы поговорим чуть позже). Таким образом, это сделает JavaScript не очень подходящим для многопоточных задач.

Неблокирующий ввод-вывод

С другой стороны, используя неблокирующий запрос, вы можете инициировать запрос данных для user2, не дожидаясь ответа на запрос user1. Вы можете инициировать оба запроса параллельно.

Неблокирующий ввод-вывод устраняет необходимость многопоточности, поскольку сервер может обрабатывать несколько запросов одновременно.

Цикл событий JavaScript

Если у вас есть 26 минут, посмотрите отличное видео-объяснение Node Event Loop: 





Если нету, вот пошаговое объяснение того, как работает Event Loop в JavaScript:

cjkqjmjx1su97rhpflltovmbpva.png

1. Посылаете main() в стек вызовов.

2. Посылаете console.log() в стек вызовов. Он запускается сразу и появляется.

3. Посылаете setTimeout(2000) в стек. setTimeout(2000) это — Node API. Когда мы его вызываем, мы регистрируем пару событие-коллбек. Событие будет ждать 2000 миллисекунд, а потом вызовет коллбек.

4. После регистрации, setTimeout(2000) появляется в стеке вызовов.

5. Теперь второй setTimeout(0) регистрируется таким же образом. Теперь у нас есть два API-интерфейса Node, ожидающих выполнения.

6. После ожидания 0 секунд setTimeout(0) перемещается в очередь выполнения коллбеков (callback queue), и то же самое происходит с setTimeout(2000).

7. В очереди выполнения коллбеков функции ждут, когда стек вызовов будет пустым, потому что только одна функция может выполняться одновременно. Это обеспечивает event loop.

8. Вызывается последняя console.log(), а main() вызывается из стека вызовов.

9. Цикл событий видит, что стек вызовов пуст, а очередь обратного вызова — нет. Таким образом, он перемещает обратные вызовы (по порядку) в стек вызовов для выполнения.

Npm

bxzkwyti-qyde7en1-ieclcsp9k.png
Это библиотеки, построенные сообществом. Они решат большинство часто встречающихся проблем. npm (менеджер пакетов Node) содержит пакеты, которые вы можете использовать в своих приложениях, чтобы сделать вашу разработку более быстрой и эффективной.

Require

Require исполняет три функции:

Загружает модули, поставляемые в комплекте с Node.js, например из файловой системы или HTTP, из API Node.js.
Загружает сторонние библиотеки, такие как Express и Mongoose, которые вы устанавливаете из npm.
Позволяет создавать собственные файлы и делить проект на модули.
Require — это функция, и она принимает параметр «путь» и возвращает module.exports.

Node модули

Node модули это — многоразово используемые блоки кода, существование которых не случайно не влияет на другой код.

Вы можете написать свои собственные модули и использовать их в различных приложениях. Node.js имеет набор встроенных модулей, которые вы можете использовать без специальной установки.

V8 ускоряет JavaScript, используя C ++

V8 – движок с открытым исходным кодом, написанный на C ++.

JavaScript -> V8 (C ++) -> машинный код

V8 реализует сценарий ECMAScript, как указано в ECMA-262. ECMAScript был создан Ecma International для стандартизации JavaScript.

V8 может работать автономно или может быть встроен в любое приложение C ++. Благодаря этому, вы можете написать свой собственный код на C ++, и сделать его доступным для JavaScript.

События

События – это все, что произошло в нашем приложении, и на что мы можем ответить. 

В Node есть два типа событий:

Системные события: ядро C ++ из библиотеки libuv. (Например, окончание чтение файла).
Пользовательские события: ядро JavaScript.